<!DOCTYPE html>
<html lang="en-us">
<head>

    <style type="text/css">
      #mc_embed_signup {
        margin-top: 50px;
        margin-bottom: 50px;
        background:#fff;
        display: flex;
        justify-content: center;
        font:14px "Open Sans",Arial,sans-serif;
      }
      #mc_embed_signup input.button {
        background: black;
      }
    </style>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    


    
        <meta name="twitter:card" content="summary"/>
    



<meta name="twitter:title" content="An Alternative Multiproject Setup for Android Studio"/>
<meta name="twitter:description" content=""/>
<meta name="twitter:site" content="@philosohacker"/>



  	<meta property="og:title" content="An Alternative Multiproject Setup for Android Studio &middot; Philosophical Hacker" />
  	<meta property="og:site_name" content="Philosophical Hacker" />
  	<meta property="og:url" content="https://www.philosophicalhacker.com/2014/10/03/an-alternative-multiproject-setup-for-android-studio/" />
    
    
        
            <meta property="og:image" content="https://www.philosophicalhacker.com/images/cropped-thinker.jpg"/>
        
    

    
    <meta property="og:description" content="" />
  	<meta property="og:type" content="article" />
    <meta property="og:image" content="https://www.philosophicalhacker.com/" />
    <meta property="article:published_time" content="2014-10-03T03:02:54Z" />

    
    <meta property="article:tag" content="android" />
    
    <meta property="article:tag" content="android studio" />
    
    <meta property="article:tag" content="multiproject setups" />
    
    

    <title>An Alternative Multiproject Setup for Android Studio &middot; Philosophical Hacker</title>

    
    <meta name="description" content="" />
    

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="https://www.philosophicalhacker.com/images/favicon.ico">
	  <link rel="apple-touch-icon" href="https://www.philosophicalhacker.com/images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="https://www.philosophicalhacker.com/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="https://www.philosophicalhacker.com/css/nav.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:400,700,700italic,400italic|Open+Sans:700,400|Inconsolata" />

    

    
      
          <link href="https://www.philosophicalhacker.com/index.xml" rel="alternate" type="application/rss+xml" title="Philosophical Hacker" />
      
      
    
    <meta name="generator" content="Hugo 0.19" />

    <link rel="canonical" href="https://www.philosophicalhacker.com/2014/10/03/an-alternative-multiproject-setup-for-android-studio/" />
    
  
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-63544399-1', 'auto');
      ga('send', 'pageview');

    </script>
  


    
      
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": 
    },
    "author": {
        "@type": "Person",
        "name": ,
        
        "url": ,
        "sameAs": [
            
            
             
             
             
             
             
            
        ]
    },
    "headline": An Alternative Multiproject Setup for Android Studio,
    "name": An Alternative Multiproject Setup for Android Studio,
    "wordCount": 960,
    "timeRequired": "PT5M",
    "inLanguage": {
      "@type": "Language",
      "alternateName": en
    },
    "url": https://www.philosophicalhacker.com/2014/10/03/an-alternative-multiproject-setup-for-android-studio/,
    "datePublished": 2014-10-03T03:02Z,
    "dateModified": 2014-10-03T03:02Z,
    
    "keywords": android, android studio, multiproject setups,
    "description": ,
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": https://www.philosophicalhacker.com/2014/10/03/an-alternative-multiproject-setup-for-android-studio/
    }
}
    </script>
    


    

    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-63544399-1', 'auto');
      ga('send', 'pageview');

    </script>
    

    
</head>

<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/">Home</a>
            </li>
        
    </ul>
    
    
    <a class="subscribe-button icon-feed" href="https://www.philosophicalhacker.com/index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">




<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
  
      <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">An Alternative Multiproject Setup for Android Studio</h1>
        <small></small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2014-10-03T03:02:54Z">
            Oct 3, 2014
          </time>
        
         
          <span class="post-tag small"><a href="https://www.philosophicalhacker.com/tags/android/">#android</a></span>
         
          <span class="post-tag small"><a href="https://www.philosophicalhacker.com/tags/android-studio/">#android studio</a></span>
         
          <span class="post-tag small"><a href="https://www.philosophicalhacker.com/tags/multiproject-setups/">#multiproject setups</a></span>
         
         <strong>&middot; 5 minute read</strong>
        </section>
    </header>

    <section class="post-content">
      

<p>Google&rsquo;s <a href="http://tools.android.com/tech-docs/new-build-system/user-guide">Gradle Plugin user guide recommends</a> a method for configuring your gradle files to build multiple projects. That method has some shortcomings. In this post, I will briefly explain Google&rsquo;s recommended configuration, note its shortcomings, and  recommend a different way to configure your gradle files to support multi-project setups in Android Studio.</p>

<h2 id="the-google-way">The Google Way</h2>

<p><a href="http://www.philosophicalhacker.com/wp-content/uploads/2014/10/screen-shot-2014-10-02-at-9-31-31-pm.png"><img src="http://www.philosophicalhacker.com/wp-content/uploads/2014/10/screen-shot-2014-10-02-at-9-31-31-pm.png?w=620" alt="Screen Shot 2014-10-02 at 9.31.31 PM" /></a></p>

<p>This picture illustrates how Google suggests we handle multi-project setups: our main &ldquo;app&rdquo; module is supposed to depend on library modules that reside within the project directory. When the library modules are within the project directory, telling gradle to build them is easy. Our <code>settings.gradle</code> file looks like this:</p>

<p><a href="http://www.philosophicalhacker.com/wp-content/uploads/2014/10/screen-shot-2014-10-02-at-9-34-33-pm.png"><img src="http://www.philosophicalhacker.com/wp-content/uploads/2014/10/screen-shot-2014-10-02-at-9-34-33-pm.png?w=620" alt="Screen Shot 2014-10-02 at 9.34.33 PM" /></a></p>

<p>And our <code>build.gradle</code> looks like this:</p>

<p><a href="http://www.philosophicalhacker.com/wp-content/uploads/2014/10/screen-shot-2014-10-02-at-10-38-08-pm.png"><img src="http://www.philosophicalhacker.com/wp-content/uploads/2014/10/screen-shot-2014-10-02-at-10-38-08-pm.png?w=620" alt="Screen Shot 2014-10-02 at 10.38.08 PM" /></a></p>

<p>As you can see, Google&rsquo;s suggested configuration is simple, and its even simpler if you use the Android Studio UI to configure you gradle files for you. In spite of it&rsquo;s simplicity, there are several reasons why we might want to avoid this configuration. I discuss those reasons in the next section.</p>

<h2 id="some-unfortunate-features-of-the-google-way">Some Unfortunate Features of &ldquo;The Google Way&rdquo;</h2>

<p>Both of the unfortunate features of the &ldquo;Google way&rdquo; of handling multi-project setups only arise if your working on several apps that depend on the same libraries. If you only ever work on one app and you know for sure you wont have multiple apps that depend on the same library, feel free to skip the rest of this post and continue blissfully using the simple configuration for multiple projects in Android Studio. If, on the other hand, you are working on several apps that depend on the same libraries, read on.</p>

<p>Suppose you&rsquo;ve got a project structure that looks something like this:</p>

<blockquote>
<p>App1 depends on the <a href="https://github.com/emilsjolander/StickyListHeaders">StickyListHeaders</a> library</p>

<p>App2 depends on the StickyListHeaders library</blockquote></p>
</blockquote>

<p>If you were to follow the Google&rsquo;s user guide in setting up your projects, then you would create two projects, one for App1 and another for App2. The project directories for App1 and App2 would each contain a submodule that has the code from the StickyListHeaders library that each app needs to build successfully.</p>

<p>It doesn&rsquo;t take make to see the unfortunate features of this setup. First off, you have to have copies of a library for every app that depends on it.</p>

<p>If you frequently make changes to that library, you&rsquo;re going to want it to be versioned, and you probably want to have the library in a repository that&rsquo;s separate from your app so that you can checkout the library and reuse it for any app that needs it. Since the library module is a subdirectory within the project, you&rsquo;ll have to use git submodules to achieve this. As <a href="http://codingkilledthecat.wordpress.com/2012/04/28/why-your-company-shouldnt-use-git-submodules/">others have noted</a>, however, git submodules aren&rsquo;t really that great.</p>

<p>So, if you follow the Google way, you&rsquo;re sort of¹ forced to have copies of your libraries for all of your apps that depend on those libraries and if you change those libraries often, then you might have to start using git submodules.²</p>

<h2 id="a-different-way">A Different Way</h2>

<p>It turns out there&rsquo;s a better way to manage multiple projects in Android Studio. The trick is to create separate Android Studio projects for your libraries and to tell gradle that the module for the library that your app depends on is located in the library&rsquo;s project directory. If you wanted to use this method with the project structure I&rsquo;ve described above, you would do the following:</p>

<ol>
<li><p>Create an Android Studio project for the StickyListHeaders library</p></li>

<li><p>Create an Android Studio project for App2</p></li>

<li><p>Create an Android Studio project for App1</p></li>

<li><p>Configure App1 and App2 to build the modules in the StickyListHeaders project.</p></li>
</ol>

<p>The 4th step is the hard part, so that&rsquo;s the only step that I&rsquo;ll describe in detail. You can reference modules that are external to your project&rsquo;s directory by adding a <code>project</code> statement in your <code>settings.gradle</code> file and by setting the <code>projectDir</code> property on the <code>ProjectDescriptor</code> object that&rsquo;s returned by that <code>project</code> statement:</p>

<p><a href="http://www.philosophicalhacker.com/wp-content/uploads/2014/10/screen-shot-2014-10-02-at-10-29-45-pm.png"><img src="http://www.philosophicalhacker.com/wp-content/uploads/2014/10/screen-shot-2014-10-02-at-10-29-45-pm.png?w=620" alt="Screen Shot 2014-10-02 at 10.29.45 PM" /></a></p>

<p>If you&rsquo;ve done this correctly, you&rsquo;ll notice that the modules referenced by your project will show up in the project navigator, even if those modules are external to the project directory:</p>

<p><a href="http://www.philosophicalhacker.com/wp-content/uploads/2014/10/screen-shot-2014-10-02-at-10-31-30-pm.png"><img src="http://www.philosophicalhacker.com/wp-content/uploads/2014/10/screen-shot-2014-10-02-at-10-31-30-pm.png?w=620" alt="Screen Shot 2014-10-02 at 10.31.30 PM" /></a></p>

<p>This allows you to work on library code and app code simultaneously. Version control integration also works just fine when you reference modules externally this way. You can commit and push your modifications to the library code just like you can commit and push modifications to your app code.</p>

<p>This way of setting up multiple projects avoids the difficulties that plague Google&rsquo;s recommended configuration. Because we are referencing a module that is outside of the project directory we don&rsquo;t have to make extra copies of the library module for every app that depends on it and we can version our libraries without any sort of git submodule nonsense.</p>

<p>Unfortunately, this other way of setting up multiple projects is very difficult to find. Obviously, its not something you&rsquo;ll figure out from looking at Google&rsquo;s guide, and at this point, there&rsquo;s no way to configure your projects in this way by using the UI of Android Studio. I&rsquo;m hoping that&rsquo;ll change by the time Android Studio hits 1.0</p>

<p>If you&rsquo;ve got any concerns with this setup or if you have a better alternative, I&rsquo;d love to hear it!</p>

<h2 id="notes">Notes:</h2>

<ol>
<li><p>I say &ldquo;sort of&rdquo; because you aren&rsquo;t exactly stuck between the two options I&rsquo;ve discussed here. You could also turn your libraries into maven artifacts and include them into your app that way. This method, however, does not allow you to work on your library code and app code simultaneously unless you run multiple instances of Android Studio. Aint nobody got the memory for that.</p></li>

<li><p>Well, there are alternatives to git submodules that might offer a decent solution here, but why make things so complicated, when you can simply do what I&rsquo;ve suggested in this post.</p></li>
</ol>

    </section>


  <footer class="post-footer">


    

    <section>
  <h3>We're hiring mid-senior Android developers at <a href="http://www.unikey.com/">Unikey</a>. Email me if you want to work for a Startup in the smart lock space in Orlando</h2>
  <h4>kmatthew[dot]dupree[at][google'semailservice][dot]com</h3>
</section>


    
<link href="//cdn-images.mailchimp.com/embedcode/slim-10_7.css" rel="stylesheet" type="text/css">
<div id="mc_embed_signup">
<form action="//appspot.us11.list-manage.com/subscribe/post?u=9612e1a3261cb5689813bf38b&amp;id=0c5f737d6c" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
	<label for="mce-EMAIL">Subscribe to Philosophical Hacker</label>
	<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_9612e1a3261cb5689813bf38b_0c5f737d6c" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>



    
<section class="share">
  <h4>Share this post</h4>
  <a class="icon-twitter" style="font-size: 1.4em" href="https://twitter.com/share?text=An%20Alternative%20Multiproject%20Setup%20for%20Android%20Studio&nbsp;-&nbsp;Philosophical%20Hacker&amp;url=https%3a%2f%2fwww.philosophicalhacker.com%2f2014%2f10%2f03%2fan-alternative-multiproject-setup-for-android-studio%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
      <span class="hidden">Twitter</span>
  </a>
  <a class="icon-facebook" style="font-size: 1.4em" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.philosophicalhacker.com%2f2014%2f10%2f03%2fan-alternative-multiproject-setup-for-android-studio%2f"
      onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
      <span class="hidden">Facebook</span>
  </a>
  <a class="icon-pinterest" style="font-size: 1.4em" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fwww.philosophicalhacker.com%2f2014%2f10%2f03%2fan-alternative-multiproject-setup-for-android-studio%2f&amp;description=An%20Alternative%20Multiproject%20Setup%20for%20Android%20Studio"
      onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
      <span class="hidden">Pinterest</span>
  </a>
  <a class="icon-google-plus" style="font-size: 1.4em" href="https://plus.google.com/share?url=https%3a%2f%2fwww.philosophicalhacker.com%2f2014%2f10%2f03%2fan-alternative-multiproject-setup-for-android-studio%2f"
     onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
      <span class="hidden">Google+</span>
  </a>
</section>



    

<div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname = 'philosophicalhacker';
  var disqus_url = 'https:\/\/www.philosophicalhacker.com\/2014\/10\/03\/an-alternative-multiproject-setup-for-android-studio\/';
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>




  </footer>
</article>

</main>


  <aside class="read-next">
  
      <a class="read-next-story" style="no-cover" href="/2015/01/18/build-apps-smarter-with-archiva-and-gradle/">
          <section class="post">
              <h2>Build Apps Smarter With Archiva and Gradle</h2>
              
          </section>
      </a>
  
  
      <a class="read-next-story prev" style="no-cover" href="/2014/05/27/some-responses-to-your-comments-on-why-paul-graham-is-sort-of-wrong-about-philosophy/">
          <section class="post">
              <h2>A response to Your Comments on &#34;Why Paul Graham is (sort of) wrong about philosophy&#34;</h2>
          </section>
      </a>
  
</aside>



<div class="rc-scout" style="margin-top: 50px; text-align: center;"></div>
<footer class="site-footer clearfix">
    <section class="copyright"><a href="">Philosophical Hacker</a> </section>
    
    <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
    
</footer>
</div>
<script type="text/javascript" src="https://www.philosophicalhacker.com/js/jquery.js"></script>
<script type="text/javascript" src="https://www.philosophicalhacker.com/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="https://www.philosophicalhacker.com/js/index.js"></script>

<script async defer src="https://www.recurse-scout.com/loader.js?t=b7a91d718a76fe21289fbe7d51a58f19"></script>

</body>

</html>
